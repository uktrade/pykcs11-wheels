<h1 align="center">Welcome to pykcs11-wheels</h1>
<p>
  <a href="https://opensource.org/licenses/MIT" target="_blank">
    <img alt="License: MIT" src="https://img.shields.io/badge/License-MIT-yellow.svg" />
  </a>

<a href="https://circleci.com/gh/uktrade/pykcs11-wheels" target="_blank">
    <img alt="CircleCI Status" src="https://circleci.com/gh/uktrade/pykcs11-wheels.svg?style=svg" />
  </a></p>

> Automatic binary wheels for pykcs11

This repository contains configuration to create a binary python wheel for the
pykcs11 library which is used in the
[lite-api](https://github.com/uktrade/lite-api) project.

It uses the [autowheel](https://github.com/astrofrog/autowheel) project to build
the binary wheel in CircleCI.

The CircleCI job runs on a nightly schedule and checks pypi for any new version
of `pykcs11`. It will then build a binary wheel for all versions newer than the
base version specified in [authwheel.yml](./autowheel.yml).

### üè† [Output](https://d2vy6p688s397g.cloudfront.net/simple/)

The generated wheels are stored in a s3 bucket created by webops and set up to
be a static website. Credentials for this can be found in rattic.

The output can be accessed via: https://d2vy6p688s397g.cloudfront.net/simple/

#### Usage

To use wheels generated by this repository set an environment variable called
`PIP_EXTRA_INDEX_URL=https://d2vy6p688s397g.cloudfront.net/simple/`

`pip` will understand that it needs to look for packages in this location in
addition to pypi and because pip prefers binary wheels when possible it will
download `pykcs11` from here.

## Background

This exists to avoid having to do this:
https://github.com/uktrade/lite-api/blob/f453ee54ed0ec90b3ea2c15d786f74a3b9cdecbb/Procfile#L1
where a pip install is performed before the web server is started. The reason
this is being done is that the buildpack is unable to build `pykcs11` during the
`compile` stage.

¬© **Department For International Trade**

## License

This project is [MIT](https://opensource.org/licenses/MIT) licensed.
